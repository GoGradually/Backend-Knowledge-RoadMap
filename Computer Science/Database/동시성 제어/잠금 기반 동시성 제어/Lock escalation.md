# 락 에스컬레이션이란?
- 많은 수의 하위 레벨 락을 상위 레벨의 하나의 락으로 전환하는 과정
- 예: 많은 row-level 락들을 하나의 table-level 락으로 전환


# 락 에스컬레이션이 필요한 이유
1) 메모리 관리
   - 각 락은 메모리를 소비
   - 너무 많은 락은 메모리 부족 초래
   
2) 관리 오버헤드 감소
   - 락 획득/해제의 오버헤드 감소
   - 시스템 성능 향상

3) Lock Manager의 효율성
   - 적은 수의 락으로 관리 용이
   - 데드락 감지가 더 효율적


# 락 에스컬레이션의 작동 방식
트리거 조건:
- 특정 개수 이상의 row lock 발생
- Lock Manager의 메모리 사용량 임계치 도달
- 특정 비율 이상의 테이블이 락됨

예시:
1) 트랜잭션이 테이블의 row들을 순차적으로 락
2) row lock 개수가 임계값(예: 5000개) 도달
3) DBMS가 자동으로 table-level lock으로 전환


# 장점
- 메모리 사용량 감소 
- 시스템 리소스 효율적 사용 
- Lock Manager 부하 감소

# 단점
- 동시성 감소 가능성 
- 불필요한 락 범위 확대 
- 데드락 가능성 증가

# 락 에스컬레이션 모니터링 및 튜닝
### 모니터링 포인트:
1) Lock escalation 발생 빈도
2) Lock escalation으로 인한 대기 시간
3) 영향받는 트랜잭션 수

### 튜닝 방안:
1) 배치 크기 조정
2) 트랜잭션 분할
3) 테이블 파티셔닝
4) 임계값 조정


# 실무에서 주의할 점
1) 배치 작업 설계 시
   - Lock escalation 임계값 고려
   - 적절한 배치 크기 설정

2) 테이블 설계 시
   - 파티셔닝 고려
   - 인덱스 전략 수립

3) 모니터링
   - Lock escalation 발생 추적
   - 성능 영향 분석